<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Tutorial · Qumulants.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">Qumulants.jl</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li class="is-active"><a class="tocitem" href>Tutorial</a></li><li><a class="tocitem" href="../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Tutorial</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Tutorial</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/david-pl/Qumulants.jl/blob/master/docs/src/tutorial.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Tutorial-1"><a class="docs-heading-anchor" href="#Tutorial-1">Tutorial</a><a class="docs-heading-anchor-permalink" href="#Tutorial-1" title="Permalink"></a></h1><p>The basic usage is probably best illustrated with a brief example. In the following, we solve a simple model for a single-atom laser.</p><p>We start by loading the package, defining some symbolic parameters and the photonic annihilation operator <code>a</code> as well as the atomic lowering operator <code>s</code>. This allows us to quickly write down the Hamiltonian and the collapse operators of the system with their corresponding decay rates.</p><pre><code class="language-julia">using Qumulants

# Define parameters
@parameters Δ g γ κ ν

# Define hilbert space
hf = FockSpace(:cavity)
ha = NLevelSpace(:atom,(:g,:e))
h = hf ⊗ ha

# Define the fundamental operators
a = Destroy(h,:a)
s = Transition(h,:σ,:g,:e)

# Hamiltonian
H = Δ*a&#39;*a + g*(a&#39;*s + a*s&#39;)

# Collapse operators
J = [a,s,s&#39;]
rates = [κ,γ,ν]</code></pre><p>Now, we define a list of operators of which we want to compute the Heisenberg equations. We will only consider products of two operators. This is because later we will compute the dynamics of the system up to second order.</p><pre><code class="language-julia"># Derive a set of Heisenberg equations
ops = [a&#39;*a,s&#39;*s,a&#39;*s]
he = heisenberg(ops,H,J;rates=rates)</code></pre><p>\begin{align} \frac{d}{dt} a^\dagger a =&amp; -1.0 i g a^\dagger \sigma^{ge} + 1.0 i g a \sigma^{eg} -1.0 \kappa a^\dagger a \\
\frac{d}{dt} \sigma^{ee} =&amp; -1.0 \gamma \sigma^{ee} -1.0 \nu \sigma^{ee} + 1.0 i g a^\dagger \sigma^{ge} -1.0 i g a \sigma^{eg} + \nu \\
\frac{d}{dt} a^\dagger \sigma^{ge} =&amp; 1.0 i g \sigma^{ee} -1.0 i g a^\dagger a + 1.0 i \Delta a^\dagger \sigma^{ge} -0.5 \gamma a^\dagger \sigma^{ge} -0.5 \kappa a^\dagger \sigma^{ge} -0.5 \nu a^\dagger \sigma^{ge} + 2.0 i g a^\dagger a \sigma^{ee} \end{align}</p><p>The equations derived above are differential equations for operators. In order to convert them to <em>c</em>-number equations, we need to average over them. To obtain a closed set of equations, we expand higher-order products to second order.</p><pre><code class="language-julia"># Average the above equations and expand to second order
he_avg = average(he,2)</code></pre><p>\begin{align} \frac{d}{dt} \langle a^\dagger  a\rangle  =&amp; -1.0 i g \langle a^\dagger  \sigma^{ge}\rangle  + 1.0 i g \langle a  \sigma^{eg}\rangle  -1.0 \kappa \langle a^\dagger  a\rangle  \\
\frac{d}{dt} \langle \sigma^{ee}\rangle  =&amp; -1.0 \langle \sigma^{ee}\rangle  \left( \gamma + \nu \right) + 1.0 i g \langle a^\dagger  \sigma^{ge}\rangle  -1.0 i g \langle a  \sigma^{eg}\rangle  + \nu \\
\frac{d}{dt} \langle a^\dagger  \sigma^{ge}\rangle  =&amp; 1.0 i \langle \sigma^{ee}\rangle  g + 2.0 i \left( \langle a^\dagger\rangle  \langle a  \sigma^{ee}\rangle  + \langle a\rangle  \langle a^\dagger  \sigma^{ee}\rangle  + \langle \sigma^{ee}\rangle  \langle a^\dagger  a\rangle  -2 \langle a^\dagger\rangle  \langle a\rangle  \langle \sigma^{ee}\rangle  \right) g -1.0 i g \langle a^\dagger  a\rangle  + 1.0 i \Delta \langle a^\dagger  \sigma^{ge}\rangle  -0.5 \gamma \langle a^\dagger  \sigma^{ge}\rangle  -0.5 \kappa \langle a^\dagger  \sigma^{ge}\rangle  -0.5 \nu \langle a^\dagger  \sigma^{ge}\rangle  \end{align}</p><p>The first-order contributions are always zero and can therefore be neglected. You can try adding <code>a</code> and <code>s</code> to the list of operators <code>ops</code> in order to see that yourself. Or, even more conveniently, you can use <code>complete(he_avg)</code>, which will automatically find all missing averages and compute the corresponding equations.</p><p>Here, though, we will proceed by finding the missing averages, and neglecting them as zero using the <code>substitute</code> function.</p><pre><code class="language-julia"># Find the missing averages
missed = find_missing(he_avg)

# Substitute them as zero
subs = Dict(missed .=&gt; 0)
he_nophase = simplify_constants(substitute(he_avg, subs))</code></pre><p>\begin{align} \frac{d}{dt} \langle a^\dagger  a\rangle  =&amp; -1.0 i g \langle a^\dagger  \sigma^{ge}\rangle  + 1.0 i g \langle a  \sigma^{eg}\rangle  -1.0 \kappa \langle a^\dagger  a\rangle  \\
\frac{d}{dt} \langle \sigma^{ee}\rangle  =&amp; -1.0 \langle \sigma^{ee}\rangle  \left( \gamma + \nu \right) + 1.0 i g \langle a^\dagger  \sigma^{ge}\rangle  -1.0 i g \langle a  \sigma^{eg}\rangle  + \nu \\
\frac{d}{dt} \langle a^\dagger  \sigma^{ge}\rangle  =&amp; 1.0 i \langle \sigma^{ee}\rangle  g -1.0 i g \langle a^\dagger  a\rangle  + 1.0 i \Delta \langle a^\dagger  \sigma^{ge}\rangle  -0.5 \gamma \langle a^\dagger  \sigma^{ge}\rangle  -0.5 \kappa \langle a^\dagger  \sigma^{ge}\rangle  -0.5 \nu \langle a^\dagger  \sigma^{ge}\rangle  + 2.0 i \langle \sigma^{ee}\rangle  g \langle a^\dagger  a\rangle  \end{align}</p><p>Finally, we can generate Julia code from the above set of equations which can be solved directly using the <a href="https://github.com/JuliaDiffEq/OrdinaryDiffEq.jl">OrdinaryDiffEq</a>.</p><pre><code class="language-julia"># Generate a Julia function that to solve numerically
p = (Δ, g, γ, κ, ν)
f = generate_ode(he_nophase,p)

# Solve the system using the OrdinaryDiffEq package
using OrdinaryDiffEq
u0 = zeros(ComplexF64,length(ops))
p0 = (0, 1.5, 0.25, 1, 4)
prob = ODEProblem(f,u0,(0.0,10.0),p0)
sol = solve(prob,RK4())</code></pre><p>The photon number of our laser and the excited state population of the atom are now stored in the first two fields of <code>sol.u</code>.</p><pre><code class="language-julia">using Plots
n = real.(getindex.(sol.u, 1))
pe = real.(getindex.(sol.u, 2))
plot(sol.t, n, label=&quot;Photon number&quot;, xlabel=&quot;t&quot;)
plot!(sol.t, pe, label=&quot;Excited state population&quot;)</code></pre><pre><code class="language-none">/home/travis/.julia/packages/GR/BwGt2/src/../deps/gr/bin/gksqt: error while loading shared libraries: libQt5Widgets.so.5: cannot open shared object file: No such file or directory
connect: Connection refused
GKS: can&#39;t connect to GKS socket application

GKS: Open failed in routine OPEN_WS
GKS: GKS not in proper state. GKS must be either in the state WSOP or WSAC in routine ACTIVATE_WS</code></pre><p><img src="../tutorial.svg" alt="Photon number and excited state population"/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Introduction</a><a class="docs-footer-nextpage" href="../api/">API »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Friday 11 September 2020 11:41">Friday 11 September 2020</span>. Using Julia version 1.5.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
